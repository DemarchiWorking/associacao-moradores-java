<div class="bg-gray-100 min-h-screen">
  <div class="container mx-auto">
    <div class="p-4 md:p-8">
      <div class="relative h-80 rounded-lg shadow-md">
        <img src="../../../assets/publico.png" alt="Capa do perfil do usuário" loading="lazy" class="absolute inset-0 w-full h-full object-cover rounded-t-2xl">
        <div class="absolute left-10 -bottom-32">
          <div class="w-64 h-64 bg-red-500 rounded-full border-4 border-white shadow-lg flex items-center justify-center">
            <img [src]="usuarioLogado?.foto || 'https://www.llt.at/wp-content/uploads/2021/11/blank-profile-picture-g77b5d6651-1280-705x705.png'" loading="lazy" alt="Foto de Perfil do usuário" class="rounded-full w-full h-full object-cover">
          </div>
        </div>
      </div>

      <div class="mt-24 px-4">
        <div class="flex items-center">
          <div class="w-64 mr-4"></div>
          <div class="flex-grow">
            <div class="flex items-center flex-wrap">
              <h1 class="text-3xl font-bold text-gray-800 mr-2">{{ usuarioLogado?.nome }} {{ usuarioLogado?.sobrenome }}</h1>
              <div class="flex items-center space-x-2 mt-1">
                <span *ngIf="userProfile.isAlumn" class="px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full">
                  Usuario
                </span>
                <div class="flex items-center text-green-500 text-sm font-semibold">
                  <span class="inline-block w-2 h-2 bg-green-500 rounded-full mr-1"></span>
                  {{ usuarioLogado?.status }}
                </div>
              </div>
            </div>
          </div>
          <div class="ml-auto">
            <button class="text-gray-500 hover:text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405C18.21 14.542 18 13.593 18 12V9c0-3.313-2.687-6-6-6S6 5.687 6 9v3c0 .593-.21 1.542-.595 2.595L4 17h5m6 0v2a3 3 0 01-6 0v-2m6 0H9" />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="mt-8 border-b border-gray-200">
        <nav class="-mb-px flex space-x-12 px-4" aria-label="Tabs">
          <button 
            (click)="setActiveTab('perfil')"
            [ngClass]="{
              'border-blue-500 text-blue-600': activeTab === 'perfil',
              'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'perfil'
            }"
            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200"
          >
            Perfil
          </button>
          <button 
            (click)="setActiveTab('produtos')"
            [ngClass]="{
              'border-blue-500 text-blue-600': activeTab === 'produtos',
              'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'produtos'
            }"
            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200"
          >
            Produtos
          </button>
          <button 
            (click)="setActiveTab('vendas')"
            [ngClass]="{
              'border-blue-500 text-blue-600': activeTab === 'vendas',
              'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'vendas'
            }"
            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200"
          >
            Vendas
          </button>
        </nav>
      </div>

        <div *ngIf="activeTab === 'perfil'" class="bg-white p-6 rounded-lg shadow-md">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-gray-800">Detalhes</h2>
            <button *ngIf="!editandoPerfil"
                    (click)="habilitarEdicao()"
                    class="text-blue-500 hover:text-blue-600 font-semibold">
              Editar
            </button>
          </div>

          <form *ngIf="editandoPerfil" [formGroup]="perfilForm" (ngSubmit)="salvarPerfil()">
            <div class="mb-4">
              <label for="nome" class="block text-sm font-medium">Nome</label>
              <input id="nome" formControlName="nome" type="text" placeholder="Nome"
                    class="border p-2 w-full rounded" />
            </div>

            <div class="mb-4">
              <label for="sobrenome" class="block text-sm font-medium">Sobrenome</label>
              <input id="sobrenome" formControlName="sobrenome" type="text" placeholder="Sobrenome"
                    class="border p-2 w-full rounded" />
            </div>

            <div class="mb-4">
              <label for="foto" class="block text-sm font-medium">Foto</label>
              <input id="foto" formControlName="foto" type="text" placeholder="URL da foto"
                    class="border p-2 w-full rounded" />
            </div>

            <div class="flex gap-2">
              <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Salvar</button>
              <button type="button" (click)="cancelarEdicao()" class="bg-gray-300 px-4 py-2 rounded">Cancelar</button>
            </div>
          </form>

          <div *ngIf="!editandoPerfil" class="grid grid-cols-1 gap-y-4">
            <div class="flex flex-col">
              <span class="text-sm font-medium text-gray-500">Nome</span>
              <span class="mt-1 text-gray-800">{{ usuarioLogado?.nome }}</span>
            </div>
            <div class="flex flex-col">
              <span class="text-sm font-medium text-gray-500">Sobrenome</span>
              <span class="mt-1 text-gray-800">{{ usuarioLogado?.sobrenome }}</span>
            </div>
            <div class="flex flex-col">
              <span class="text-sm font-medium text-gray-500">Foto</span>
              <span class="mt-1 text-gray-800">{{ usuarioLogado?.foto }}</span>
            </div>
          </div>
        </div>

        <div *ngIf="activeTab === 'produtos'" class="bg-white p-6 rounded-lg shadow-md">
          <div id="produtos" class="produtos flex flex-col">
            <div>
              <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800">Produtos</h2>
                <button class="text-blue-500 hover:text-blue-600 font-semibold">Editar</button>
              </div>

              <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-700">{{ produtos.length }} Produtos</h3>
                <button class="px-2 py-1 bg-gray-200 text-gray-600 rounded">⋮</button>
              </div>
              
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <a *ngFor="let produto of produtos" [routerLink]="['/detalhes-produto', produto.id]" class="block bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300">
                  <img [src]="produto.imagem" [alt]="'Imagem do produto ' + produto.nome" class="w-full h-32 object-cover rounded mb-4">
                  <h3 class="text-md font-medium text-gray-800">{{ produto.nome }}</h3>
                  <p class="text-sm text-gray-500">{{ produto.steps }} Etapas</p>
                  <div class="mt-2">
                    <span
                      [ngClass]="{
                        'bg-green-100 text-green-800': produto.status === 'Concluído',
                        'bg-yellow-100 text-yellow-800': produto.status === 'Em Andamento',
                        'bg-blue-100 text-blue-800': produto.status === 'Iniciar Trilha'
                      }"
                      class="px-2 py-1 text-xs font-semibold rounded-full"
                    >
                      {{ produto.status }}
                    </span>
                  </div>
                  <p class="text-sm text-gray-600 mt-1">{{ produto.preco | currency:'BRL':'symbol':'1.2-2' }}</p>
                </a>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="activeTab === 'vendas'" class="bg-white p-6 rounded-lg shadow-md">
          <h2>Vendas</h2>
          <p>Conteúdo de vendas aqui.</p>
        </div>
      </div>
    </div>
  </div>